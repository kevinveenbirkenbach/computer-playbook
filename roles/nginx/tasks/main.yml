---
- name: install nginx
  pacman: name=nginx state=present
  notify: restart nginx

- name: Ensure nginx configuration directories are present
  file:
    path: "{{ item }}"
    state: directory
    mode: '0755'
  loop:
    - "{{nginx_servers_directory}}"
    - "{{nginx_maps_directory}}"
    - "{{nginx_upstreams_directory}}"

- name: create nginx config file
  template: src=nginx.conf.j2 dest=/etc/nginx/nginx.conf
  notify: restart nginx

- name: flush nginx service
  meta: flush_handlers
