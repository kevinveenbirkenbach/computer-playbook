---
- name: recieve {{domain}} certificate
  command: certbot certonly --agree-tos --email {{administrator_email}} --non-interactive --webroot -w /var/lib/letsencrypt/ -d {{domain}}

- name: configure {{domain}}.conf
  template: src=roles/native-docker-reverse-proxy/templates/domain.conf.j2 dest=/etc/nginx/conf.d/{{domain}}.conf
  notify: restart nginx

- name: pull docker repository
  git:
    repo: "https://github.com/akaunting/docker.git"
    dest: "/home/administrator/docker-compose/akaunting/"
    update: yes

- name: configure db.env
  template: src=db.env.j2 dest=/home/administrator/docker-compose/akaunting/env/db.env
  notify: setup akounting

- name: configure run.env
  template: src=run.env.j2 dest=/home/administrator/docker-compose/akaunting/env/run.env
  notify: setup akounting
