---
- name: general host setup
  hosts: all
  become: true
  roles:
    - system-security
    - system-update
    - native-journalctl
    #- native-hostname
- name: setup btrfs health check
  hosts: btrfs_health_check_hosts
  become: true
  roles:
    - native-btrfs-health-check
- name: setup standard wireguard hosts
  hosts: wireguard_hosts
  become: true
  roles:
    - native-wireguard
- name: setup wireguard hosts behind firewall\nat
  hosts: wireguard_behind_firewall_hosts
  become: true
  roles:
    - native-wireguard-behind-firewall

# Native Webserver Roles
- name: setup homepages
  hosts: homepage_hosts
  become: true
  roles:
   -  role: native-homepage
      vars:
        domain: "{{top_domain}}"
- name: setup redirect hosts
  hosts: redirect_hosts
  become: true
  roles:
   -  role: native-https-redirect
      vars:
        domain_mappings: "{{redirect_domain_mappings}}"

# Docker Roles
- name: setup nextcloud hosts
  hosts: nextcloud_hosts
  become: true
  roles:
   -  role: docker-nextcloud
      vars:
        domain: cloud.{{top_domain}}
        http_port: 8001
- name: setup gitea hosts
  hosts: gitea_hosts
  become: true
  roles:
   -  role: docker-gitea
      vars:
        domain: git.{{top_domain}}
        http_port: 8002
        ssh_port:  2201
        run_mode: prod
- name: setup wordpress hosts
  hosts: wordpress_hosts
  become: true
  roles:
   -  role: docker-wordpress
      vars:
        domains: "{{wordpress_domains}}"
        http_port: 8003
- name: setup mediawiki hosts
  hosts: mediawiki_hosts
  become: true
  roles:
   -  role: docker-mediawiki
      vars:
        domain: wiki.{{top_domain}}
        http_port: 8004
- name: setup mybb hosts
  hosts: mybb_hosts
  become: true
  roles:
   -  role: docker-mybb
      vars:
        domain: forum.{{top_domain}}
        http_port: 8005
- name: setup turn server
  hosts: turn_server_hosts
  become: true
  roles:
   -  role: docker-turn-server
- name: setup yourls hosts
  hosts: yourls_hosts
  become: true
  roles:
   -  role: docker-yourls
      vars:
        domain: s.{{top_domain}}
        http_port: 8006
- name: setup mailu hosts
  hosts: mailu_hosts
  become: true
  roles:
   -  role: docker-mailu
      vars:
        domain: "mail.{{top_domain}}"
        http_port: 8007
- name: setup elk hosts
  hosts: elk_hosts
  become: true
  roles:
   -  role: docker-elk
      vars:
        domain: "elk.{{top_domain}}"
        http_port: 8008
- name: setup mastodon hosts
  hosts: mastodon_hosts
  become: true
  roles:
   -  role: docker-mastodon
      vars:
        domain: "mastodon.{{top_domain}}"
        http_port: 8009
        stream_port: 4001
- name: setup pixelfed hosts
  hosts: pixelfed_hosts
  become: true
  roles:
   -  role: docker-pixelfed
      vars:
        domain: pixelfed.{{top_domain}}
        http_port: 8010
- name: setup peertube hosts
  hosts: peertube_hosts
  become: true
  roles:
   -  role: docker-peertube
      vars:
        domain: peertube.{{top_domain}}
        http_port: 8011
- name: setup bigbluebutton hosts
  hosts: bigbluebutton_hosts
  become: true
  roles:
   -  role: docker-bigbluebutton
      vars:
        domain: bbb.{{top_domain}}
- name: setup funkwhale hosts
  hosts: funkwhale_hosts
  become: true
  roles:
   -  role: docker-funkwhale
      vars:
        domain: funkwhale.{{top_domain}}
        http_port: 8012
- name: setup roulette-wheel hosts
  hosts: roulette_wheel_hosts
  become: true
  roles:
   -  role: docker-roulette-wheel
      vars:
        domain: roulette.{{top_domain}}
        http_port: 8013
- name: setup akaunting hosts
  hosts: akaunting_hosts
  become: true
  roles:
   -  role: docker-akaunting
      vars:
        domain: akaunting.{{top_domain}}
        http_port: 8080

# Backup Roles
- name: setup replica backup hosts
  hosts: replica_backup_hosts
  become: true
  roles:
    - role: native-pull-primary-backups
